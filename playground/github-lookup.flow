# GitHub User Lookup
# Fetches a GitHub user's profile and summarizes their activity.

config:
    name: "GitHub User Lookup"
    version: 1

services:
    GitHub is an API at "https://api.github.com"

workflow:
    trigger: when a username is provided

    set username to request.username
    set repos to request.repos
    set followers to request.followers
    log "Looking up GitHub user: {username}"

    get profile using GitHub at "/users/{username}"
        save the result as profile

    log "Profile fetched for {username}"
    log "Public repos: {repos}, Followers: {followers}"

    step ClassifyUser:
        if repos is above 50:
            set activity to "power user"
        otherwise if repos is above 10:
            set activity to "active contributor"
        otherwise:
            set activity to "getting started"

    step CheckPopularity:
        if followers is above 1000:
            set popular to true
            log "{username} is a popular developer!"
        otherwise:
            set popular to false

    complete with username username and activity activity and repos repos and followers followers and popular popular
